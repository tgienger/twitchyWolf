(function(){function len(obj){if(obj instanceof Array||typeof obj==="string")return obj.length;else{var count=0;for(var i in obj){if(obj.hasOwnProperty(i))count++}return count}}function _$rapyd$_print(){var args,output;args=[].slice.call(arguments,0);output=JSON.stringify(args);if("console"in window)console.log(output.substr(1,output.length-2))}var myApp;"use strict";myApp=angular.module("twitchyApp",["ui.router","ui.bootstrap"]).config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/");$stateProvider.state("main",{url:"/",templateUrl:"app/partials/main.html",controller:"MainCtrl"}).state("stream",{url:"/#/stream",templateUrl:"app/partials/directives/stream.html",controller:"StreamCtrl"})}).controller("StreamCtrl",function($scope,$http,$rootScope){$scope.l=""}).controller("MainCtrl",function($scope,$http,$rootScope,$window){var url;url="https://api.twitch.tv/kraken/";$scope.clientId="jmauht7mi0ud0hptf0l8060uqe41ybw";$scope.channel={};$scope.channelStarted=false;$scope.loadingStreams=false;$scope.searchCollapsed=true;function bringFront(elem,stack){var group,min;group=$(stack);if(len(group)<1){return}min=parseInt(group[0].style.zIndex,10)||0;$(group).each(function(i){this.style.zIndex=min+1});if(elem===undefined){return}$(elem).css({"zIndex":min+len(group)})}$scope.miniMize=function(){if($scope.streams&&$scope.stream){$scope.streams={};$scope.stream.search=""}};$(".draggable").draggable({handle:".handle",stack:".windows",snap:true,containment:"document"});$scope.playVideo=function(stream){if($scope.channelStarted){$scope.channelStarted=false}$scope.channelName=stream.channel.display_name.toLowerCase();$window.open("http://localhost:8080/#/stream","width=700, height=500,toolbar=0,menubar=0,location=0,status=1,scrollbars=0,resizable=1,left=0,top=0")};$scope.queryStreams=function(stream){if(stream.search===""){$scope.streams={}}else{$scope.loadingStreams=true;$http.jsonp(url+"search/streams?callback=JSON_CALLBACK",{params:{q:stream.search,type:"suggest"}}).success(function(res){$scope.streams=res.streams;$scope.loadingStreams=false})}};$scope.queryChannel=function(channel){$http.jsonp(url+"streams/"+channel.name.toLowerCase()+"?callback=JSON_CALLBACK&client_id="+$scope.clientId).success(function(res){$scope.channelInfo=res})};$(".twitch-connect").click(function(){Twitch.login({scope:["user_read","channel_read","chat_login","channel_check_subscription","user_subscriptions","channel_stream","channel_commercial","channel_editor","user_follows_edit","user_blocks_edit"],redirect_uri:"http://localhost:8080/#/"})});$(".twitch-logout").click(function(){Twitch.logout(function(error){if(error){_$rapyd$_print(error)}$(".twitch-connect").show();$(".twitch-logout").hide()})});Twitch.init({clientId:"jmauht7mi0ud0hptf0l8060uqe41ybw"},function(error,status){if(error){_$rapyd$_print(error)}if(status.authenticated){$(".twitch-connect").hide();$(".twitch-logout").show();$rootScope.token=status.token}})}).directive("stream",function(){return{restrict:"E",scope:{channelName:"="},templateUrl:"app/partials/directives/stream.html"}}).directive("chat",function($compile){return{restrict:"A",scope:{channelName:"="},templateUrl:"app/partials/directives/chat.html",link:function(scope,element,attrs){var $body,template;$body=angular.element(document.body);template=$compile("<iframe frameborder=\"0\" scrolling=\"yes\" id=\"chat_embed\" src=\"http://twitch.tv/chat/embed?channel="+channelName+"&amp;popout_chat=true\" height=\"500\" width=\"350\"></iframe>")($scope);$body.append(template)}}})})();